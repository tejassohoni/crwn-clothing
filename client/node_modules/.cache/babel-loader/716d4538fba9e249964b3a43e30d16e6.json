{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _createSuper from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import _inherits from\"D:\\\\reactjs\\\\crwn-clothing\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from\"react\";import{Route,Switch,Redirect}from\"react-router-dom\";import{connect}from\"react-redux\";import{createStructuredSelector}from\"reselect\";import Header from\"./components/header/header.component.jsx\";import HomePage from\"./pages/homepage/homepage.component.jsx\";import SignInAndSignUpPage from\"./pages/sign-in-and-sign-up/sign-in-and-sign-up.component.jsx\";import ShopPage from\"./pages/shop/shop.component.jsx\";import CheckoutPage from\"./pages/checkout/checkout.component.jsx\";import{auth,createUserProfileDocument}from\"./firebase/firebase.utils.js\";import{selectCurrentUser}from\"./redux/user/user.selector\";import{setCurrentUser as _setCurrentUser}from\"./redux/user/user.actions\";import\"./App.css\";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(){var _this;_classCallCheck(this,App);_this=_super.call(this);_this.unsubscribeFromAuth=null;_this.state={currentUser:null};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var setCurrentUser=this.props.setCurrentUser;this.unsubscribeFromAuth=auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userAuth){var userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!userAuth){_context.next=7;break;}_context.next=3;return createUserProfileDocument(userAuth);case 3:userRef=_context.sent;userRef.onSnapshot(function(snapshot){setCurrentUser(_objectSpread({id:snapshot.id},snapshot.data()));console.log(_this2.state);});_context.next=8;break;case 7:setCurrentUser(userAuth);case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.unsubscribeFromAuth();}},{key:\"render\",value:function render(){var currentUser=this.props.currentUser;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\",component:HomePage}),/*#__PURE__*/React.createElement(Route,{path:\"/shop\",component:ShopPage}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/signin\",render:function render(){return currentUser?/*#__PURE__*/React.createElement(Redirect,{to:\"/\"}):/*#__PURE__*/React.createElement(SignInAndSignUpPage,null);}}),/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/checkout\",component:CheckoutPage})));}}]);return App;}(React.Component);var mapStateToProps=createStructuredSelector({currentUser:selectCurrentUser});var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setCurrentUser:function setCurrentUser(user){return dispatch(_setCurrentUser(user));}};};export default connect(mapStateToProps,mapDispatchToProps)(App);","map":{"version":3,"sources":["D:/reactjs/crwn-clothing/src/App.js"],"names":["React","Route","Switch","Redirect","connect","createStructuredSelector","Header","HomePage","SignInAndSignUpPage","ShopPage","CheckoutPage","auth","createUserProfileDocument","selectCurrentUser","setCurrentUser","App","unsubscribeFromAuth","state","currentUser","props","onAuthStateChanged","userAuth","userRef","onSnapshot","snapshot","id","data","console","log","Component","mapStateToProps","mapDispatchToProps","dispatch","user"],"mappings":"4vBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,KAAT,CAAgBC,MAAhB,CAAwBC,QAAxB,KAAwC,kBAAxC,CACA,OAASC,OAAT,KAAwB,aAAxB,CACA,OAASC,wBAAT,KAAyC,UAAzC,CAEA,MAAOC,CAAAA,MAAP,KAAmB,0CAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,yCAArB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,+DAAhC,CACA,MAAOC,CAAAA,QAAP,KAAqB,iCAArB,CACA,MAAOC,CAAAA,YAAP,KAAyB,yCAAzB,CACA,OAASC,IAAT,CAAeC,yBAAf,KAAgD,8BAAhD,CACA,OAASC,iBAAT,KAAkC,4BAAlC,CACA,OAASC,cAAc,GAAdA,CAAAA,eAAT,KAA+B,2BAA/B,CACA,MAAO,WAAP,C,GAEMC,CAAAA,G,sGACJ,cAAc,qCACZ,wBADY,MAOdC,mBAPc,CAOQ,IAPR,CAEZ,MAAKC,KAAL,CAAa,CACXC,WAAW,CAAE,IADF,CAAb,CAFY,aAKb,C,6EAImB,oBACVJ,CAAAA,cADU,CACS,KAAKK,KADd,CACVL,cADU,CAElB,KAAKE,mBAAL,CAA2BL,IAAI,CAACS,kBAAL,0FAAwB,iBAAOC,QAAP,kIAC7CA,QAD6C,+CAEzBT,CAAAA,yBAAyB,CAACS,QAAD,CAFA,QAEzCC,OAFyC,eAI/CA,OAAO,CAACC,UAAR,CAAmB,SAACC,QAAD,CAAc,CAC/BV,cAAc,gBACZW,EAAE,CAAED,QAAQ,CAACC,EADD,EAETD,QAAQ,CAACE,IAAT,EAFS,EAAd,CAIAC,OAAO,CAACC,GAAR,CAAY,MAAI,CAACX,KAAjB,EACD,CAND,EAJ+C,6BAY/CH,cAAc,CAACO,QAAD,CAAd,CAZ+C,sDAAxB,+DAA3B,CAeD,C,mEAEsB,CACrB,KAAKL,mBAAL,GACD,C,uCAEQ,IACCE,CAAAA,WADD,CACiB,KAAKC,KADtB,CACCD,WADD,CAEP,mBACE,4CACE,oBAAC,MAAD,MADF,cAEE,oBAAC,MAAD,mBACE,oBAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAEX,QAAjC,EADF,cAEE,oBAAC,KAAD,EAAO,IAAI,CAAC,OAAZ,CAAoB,SAAS,CAAEE,QAA/B,EAFF,cAGE,oBAAC,KAAD,EACE,KAAK,KADP,CAEE,IAAI,CAAC,SAFP,CAGE,MAAM,CAAE,wBACNS,CAAAA,WAAW,cAAG,oBAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAH,cAAyB,oBAAC,mBAAD,MAD9B,EAHV,EAHF,cAUE,oBAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,WAAlB,CAA8B,SAAS,CAAER,YAAzC,EAVF,CAFF,CADF,CAiBD,C,iBApDeV,KAAK,CAAC6B,S,EAuDxB,GAAMC,CAAAA,eAAe,CAAGzB,wBAAwB,CAAC,CAC/Ca,WAAW,CAAEL,iBADkC,CAAD,CAAhD,CAIA,GAAMkB,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,QAAD,QAAe,CACxClB,cAAc,CAAE,wBAACmB,IAAD,QAAUD,CAAAA,QAAQ,CAAClB,eAAc,CAACmB,IAAD,CAAf,CAAlB,EADwB,CAAf,EAA3B,CAIA,cAAe7B,CAAAA,OAAO,CAAC0B,eAAD,CAAkBC,kBAAlB,CAAP,CAA6ChB,GAA7C,CAAf","sourcesContent":["import React from \"react\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport { createStructuredSelector } from \"reselect\";\n\nimport Header from \"./components/header/header.component.jsx\";\nimport HomePage from \"./pages/homepage/homepage.component.jsx\";\nimport SignInAndSignUpPage from \"./pages/sign-in-and-sign-up/sign-in-and-sign-up.component.jsx\";\nimport ShopPage from \"./pages/shop/shop.component.jsx\";\nimport CheckoutPage from \"./pages/checkout/checkout.component.jsx\";\nimport { auth, createUserProfileDocument } from \"./firebase/firebase.utils.js\";\nimport { selectCurrentUser } from \"./redux/user/user.selector\";\nimport { setCurrentUser } from \"./redux/user/user.actions\";\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      currentUser: null,\n    };\n  }\n\n  unsubscribeFromAuth = null;\n\n  componentDidMount() {\n    const { setCurrentUser } = this.props;\n    this.unsubscribeFromAuth = auth.onAuthStateChanged(async (userAuth) => {\n      if (userAuth) {\n        const userRef = await createUserProfileDocument(userAuth);\n\n        userRef.onSnapshot((snapshot) => {\n          setCurrentUser({\n            id: snapshot.id,\n            ...snapshot.data(),\n          });\n          console.log(this.state);\n        });\n      } else {\n        setCurrentUser(userAuth);\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    this.unsubscribeFromAuth();\n  }\n\n  render() {\n    const { currentUser } = this.props;\n    return (\n      <div>\n        <Header />\n        <Switch>\n          <Route exact path=\"/\" component={HomePage} />\n          <Route path=\"/shop\" component={ShopPage} />\n          <Route\n            exact\n            path=\"/signin\"\n            render={() =>\n              currentUser ? <Redirect to=\"/\" /> : <SignInAndSignUpPage />\n            }\n          />\n          <Route exact path=\"/checkout\" component={CheckoutPage} />\n        </Switch>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  setCurrentUser: (user) => dispatch(setCurrentUser(user)),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"]},"metadata":{},"sourceType":"module"}